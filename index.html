<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üî• Firebase „Ç¢„Éó„É™„É¨„Éì„É•„Éº„ÉÑ„Éº„É´ v0.8</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; height: 100vh; overflow: hidden; background: #f5f6fa; }
        .container { display: flex; height: 100vh; }
        .review-panel { width: 60% !important; zoom: 0.7; background: #2f3542; color: white; padding: 20px; overflow-y: auto; box-shadow: 2px 0 10px rgba(0,0,0,0.1); }
        .header { text-align: center; margin-bottom: 15px; border-bottom: 2px solid #57606f; padding-bottom: 12px; }
        .header h1 { font-size: 1.3rem; color: #5352ed; margin-bottom: 5px; }
        .sync-status { font-size: 0.8rem; opacity: 0.8; margin-top: 5px; }
        .sync-online { color: #2ed573; }
        .sync-offline { color: #ff4757; }
        .progress { background: #57606f; border-radius: 10px; height: 8px; margin: 10px 0; overflow: hidden; }
        .progress-bar { background: linear-gradient(45deg, #5352ed, #3742fa); height: 100%; width: 0%; transition: width 0.3s ease; }
        .app-info { background: #57606f; padding: 15px; border-radius: 10px; margin-bottom: 12px; margin-top: 8px; }
        .app-name { font-weight: bold; color: #5352ed; margin-bottom: 5px; word-break: break-all; }
        .app-status { font-size: 0.9rem; opacity: 0.8; }
        .rating-section { margin-bottom: 10px; }
        .rating-title { font-weight: bold; margin-bottom: 10px; color: #a4b0be; }
        .rating-item { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding: 10px; background: #3d4454; border-radius: 8px; }
        .rating-label { font-size: 0.9rem; }
        .rating-buttons { display: grid; grid-template-columns: repeat(5, 1fr); gap: 3px; }
        .rating-row { display: flex; gap: 5px; margin-bottom: 8px; }
        .rating-item-compact { flex: 1; background: #3d4454; border-radius: 8px; padding: 8px; }
        .rating-label-compact { font-size: 0.8rem; display: block; margin-bottom: 5px; }
        .rating-buttons-compact { display: grid; grid-template-columns: repeat(5, 1fr); gap: 2px; }
        .rating-row-single { display: flex; gap: 3px; margin-bottom: 8px; }
        .rating-item-ultra { flex: 1; background: #3d4454; border-radius: 6px; padding: 4px; }
        .rating-label-ultra { font-size: 0.65rem; display: block; margin-bottom: 3px; text-align: center; }
        .rating-buttons-ultra { display: grid; grid-template-columns: repeat(5, 1fr); gap: 1px; }
        .rating-btn { width: 30px; height: 30px; border: none; border-radius: 50%; background: #57606f; color: white; font-size: 0.8rem; cursor: pointer; transition: all 0.2s ease; }
        .rating-btn:hover { background: #5352ed; transform: scale(1.1); }
        .rating-btn.active { background: #5352ed; box-shadow: 0 0 10px rgba(83, 82, 237, 0.5); }
        .memo-section { margin-bottom: 10px; }
        .memo-title { font-weight: bold; margin-bottom: 10px; color: #a4b0be; }
        .memo-textarea { width: 100%; height: 180px; background: #3d4454; border: 1px solid #57606f; border-radius: 8px; color: white; padding: 12px; font-size: 0.9rem; resize: vertical; font-family: inherit; }
        .memo-textarea:focus { outline: none; border-color: #5352ed; box-shadow: 0 0 0 2px rgba(83, 82, 237, 0.2); }
        .button-section { display: flex; gap: 10px; margin-bottom: 10px; }
        .btn { flex: 1; padding: 12px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; transition: all 0.2s ease; font-size: 0.9rem; }
        .btn-save { background: #2ed573; color: white; position: relative; overflow: hidden; }
        .btn-save:hover { background: #26d0ce; transform: translateY(-2px); }
        .btn-save.saving { background: #5352ed; animation: pulse 0.8s infinite; }
        .btn-save.success { background: #27ae60; animation: bounce 0.5s ease; }
        .btn-save.error { background: #e74c3c; animation: shake 0.5s ease; }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        @keyframes bounce {
            0%, 20%, 60%, 100% { transform: translateY(0); }
            40% { transform: translateY(-8px); }
            80% { transform: translateY(-4px); }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-4px); }
            20%, 40%, 60%, 80% { transform: translateX(4px); }
        }
        .btn-next { background: #5352ed; color: white; }
        .btn-next:hover { background: #3742fa; transform: translateY(-2px); }
        .btn-prev { background: #747d8c; color: white; }
        .btn-prev:hover { background: #57606f; transform: translateY(-2px); }
        .stats-section { background: #3d4454; padding: 15px; border-radius: 10px; margin-top: 10px; margin-bottom: 8px; }
        .stats-title { font-weight: bold; margin-bottom: 10px; color: #a4b0be; }
        .stats-item { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 0.9rem; }
        .app-display { width: 40% !important; display: flex; flex-direction: column; background: white; }
        .app-container { width: 100%; height: 100%; display: flex; justify-content: flex-start; align-items: flex-start; }
        .app-wrapper { width: 100%; height: 100%; border: none; overflow: hidden; background: white; }
        .app-header-compact { background: #2f3542; color: white; padding: 10px 15px; }
        .app-title-line #headerAppName { font-size: 0.9rem; font-weight: bold; color: #5352ed; margin-bottom: 2px; }
        .app-url-line { font-size: 0.75rem; opacity: 0.8; color: white; }
        .app-controls-bottom { background: #f5f6fa; padding: 4px 15px; display: flex; gap: 8px; border-bottom: 1px solid #ddd; }
        .app-status-bottom { background: #2f3542; padding: 6px 15px; border-top: 1px solid #ddd; }
        .app-status-text { font-size: 0.75rem; color: white; opacity: 0.9; }
        .control-btn-small { padding: 5px 10px; background: #5352ed; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.75rem; }
        .control-btn-small:hover { background: #3742fa; }
        .app-frame { width: 166.67%; height: 166.67%; border: none; background: white; transform: scale(0.6); transform-origin: 0 0; }
        .loading { display: flex; justify-content: center; align-items: center; height: 100%; font-size: 1.2rem; color: #747d8c; }
        .quick-title-row { display: flex; justify-content: space-between; align-items: center; }
        .quick-rating { display: flex; gap: 5px; }
        .quick-btn { width: 90px; height: 30px; border: none; border-radius: 15px; background: #57606f; color: white; font-size: 0.8rem; cursor: pointer; transition: all 0.2s ease; }
        .quick-btn:hover { background: #5352ed; transform: scale(1.1); }
        .quick-btn.active { background: #5352ed; box-shadow: 0 0 10px rgba(83, 82, 237, 0.5); }
        
        /* Ë™çË®º„Çª„ÇØ„Ç∑„Éß„É≥ */
        .auth-section { background: #3742fa; color: white; padding: 15px; border-radius: 10px; margin-bottom: 20px; }
        .auth-section h3 { margin-bottom: 15px; text-align: center; }
        .auth-methods { display: flex; flex-direction: column; gap: 10px; }
        .auth-btn { padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; gap: 8px; }
        .auth-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.2); }
        .google-btn { background: #4285f4; color: white; }
        .google-btn:hover { background: #3367d6; }
        .anon-btn { background: #57606f; color: white; }
        .anon-btn:hover { background: #3d4454; }
        .email-btn { background: #2ed573; color: white; }
        .email-btn:hover { background: #26d0ce; }
        
        .email-form { display: none; margin-top: 10px; }
        .email-form input { width: 100%; padding: 10px; margin: 5px 0; border: none; border-radius: 5px; font-size: 0.9rem; }
        .email-form button { width: 100%; padding: 10px; margin: 5px 0; border: none; border-radius: 5px; background: #2ed573; color: white; cursor: pointer; font-weight: bold; }
        
        .user-info { background: #2ed573; color: white; padding: 10px 15px; border-radius: 10px; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
        .user-app-info { background: #57606f; padding: 15px; border-radius: 10px; margin-bottom: 12px; margin-top: 8px; display: flex; justify-content: space-between; align-items: center; gap: 15px; }
        .top-left-section { display: flex; align-items: center; gap: 15px; flex: 1; }
        .top-nav-section { display: flex; gap: 5px; }
        .bottom-nav-section { display: flex; gap: 5px; margin-top: 15px; }
        .bottom-nav-btn { background: #5352ed; color: white; border: none; border-radius: 5px; padding: 12px 30px; font-size: 0.8rem; cursor: pointer; transition: all 0.2s ease; width: 180px; flex: 1; }
        .bottom-nav-btn:hover { background: #3742fa; transform: translateY(-1px); }
        .nav-btn:hover { background: #3742fa; transform: translateY(-1px); }
        .bottom-nav-btn.nav-save { background: #2ed573; position: relative; overflow: hidden; }
        .bottom-nav-btn.nav-save:hover { background: #26d0ce; }
        .bottom-nav-btn.nav-save.saving { background: #5352ed; animation: pulse 0.8s infinite; }
        .bottom-nav-btn.nav-save.success { background: #27ae60; animation: bounce 0.5s ease; }
        .bottom-nav-btn.nav-save.error { background: #e74c3c; animation: shake 0.5s ease; }
        .user-section { display: flex; align-items: center; gap: 8px; min-width: 0; }
        .user-avatar { width: 30px; height: 30px; border-radius: 50%; }
        .user-name { font-weight: bold; flex: 1; font-size: 0.85rem; color: white; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .logout-btn { background: #ff4757; color: white; padding: 4px 8px; border: none; border-radius: 3px; cursor: pointer; font-size: 0.75rem; white-space: nowrap; }
        .logout-btn:hover { background: #ff3838; }
        .app-section { flex: 1; min-width: 0; }
        .app-section .app-name { font-weight: bold; color: #2f3542; margin-bottom: 3px; word-break: break-all; font-size: 0.9rem; }
        .app-section .app-status { font-size: 0.8rem; font-weight: bold; color: #2f3542; }
        
        /* Android„Çø„Éñ„É¨„ÉÉ„ÉàÂØæÂøú (8„Ç§„É≥„ÉÅ 800x1280px Á∏¶Âêë„Åç) */
        @media (max-width: 900px) and (orientation: portrait) {
            .container { flex-direction: row; }
            .review-panel { width: 60% !important; }
            .app-display { width: 40% !important; }
            .app-wrapper { width: 100%; height: 100%; }
        }
        
        /* „Çπ„Éû„Éº„Éà„Éï„Ç©„É≥ÂØæÂøú */
        @media (max-width: 768px) { 
            .container { flex-direction: column; } 
            .review-panel { width: 100%; height: 40vh; } 
            .app-display { width: 100%; height: 60vh; }
            .app-wrapper { width: 90%; height: 90%; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="review-panel">
            <div class="header">
                <h1>üî• Firebase „É¨„Éì„É•„Éº„ÉÑ„Éº„É´</h1>
                <div class="sync-status" id="syncStatus">
                    <span class="sync-offline">‚ö™ Êé•Á∂ö‰∏≠...</span>
                </div>
                <div class="progress">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
                <div id="progressText">0 / 0 ÂÆå‰∫Ü</div>
            </div>

            <!-- Ë™çË®º„Çª„ÇØ„Ç∑„Éß„É≥ -->
            <div class="auth-section" id="authSection">
                <h3>üîê Google„É≠„Ç∞„Ç§„É≥„ÅåÂøÖË¶Å„Åß„Åô</h3>
                <p style="margin-bottom: 15px; font-size: 0.9rem; opacity: 0.9;">
                    üì± Ë§áÊï∞„Éá„Éê„Ç§„ÇπÈñì„Åß„ÅÆ„É™„Ç¢„É´„Çø„Ç§„É†ÂêåÊúü„ÅÆ„Åü„ÇÅ„ÄÅGoogle„Ç¢„Ç´„Ç¶„É≥„Éà„Åß„ÅÆ„É≠„Ç∞„Ç§„É≥„ÅåÂøÖË¶Å„Åß„Åô
                </p>
                <div class="auth-methods">
                    <button class="auth-btn google-btn" onclick="signInWithGoogle()">
                        üîµ Google„ÅßÁ∂öË°å
                    </button>
                </div>
            </div>

            <!-- „É¶„Éº„Ç∂„ÉºÊÉÖÂ†±„Å®„Ç¢„Éó„É™ÊÉÖÂ†±„Å®„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ -->
            <div class="user-app-info" id="userAppInfo" style="display: none;">
                <div class="top-left-section">
                    <div class="user-section">
                        <img id="userAvatar" class="user-avatar" style="display: none;">
                        <div class="user-name" id="userDisplay"></div>
                        <button class="logout-btn" onclick="signOut()">„É≠„Ç∞„Ç¢„Ç¶„Éà</button>
                    </div>
                    <div class="app-section">
                        <div class="app-name" id="currentAppName">„Ç¢„Éó„É™„ÇíË™≠„ÅøËæº„Åø‰∏≠...</div>
                        <div class="app-status" id="currentAppStatus">Áä∂ÊÖã: Á¢∫Ë™ç‰∏≠</div>
                    </div>
                </div>
            </div>

            <div class="app-info" id="appInfoFallback">
                <div class="app-name" id="currentAppNameFallback">„Ç¢„Éó„É™„ÇíË™≠„ÅøËæº„Åø‰∏≠...</div>
                <div class="app-status" id="currentAppStatusFallback">Áä∂ÊÖã: Á¢∫Ë™ç‰∏≠</div>
            </div>

            <div class="rating-section">
                <div class="quick-title-row">
                    <div class="rating-title">‚ö° „ÇØ„Ç§„ÉÉ„ÇØË©ï‰æ°</div>
                    <div class="quick-rating">
                        <button class="quick-btn" onclick="quickRating(1)">1</button>
                        <button class="quick-btn" onclick="quickRating(2)">2</button>
                        <button class="quick-btn" onclick="quickRating(3)">3</button>
                        <button class="quick-btn" onclick="quickRating(4)">4</button>
                        <button class="quick-btn" onclick="quickRating(5)">5</button>
                    </div>
                </div>
            </div>

            <div class="rating-section">
                <div class="rating-title">üìä Ë©≥Á¥∞Ë©ï‰æ° (10ÁÇπÊ∫ÄÁÇπ)</div>
                <div class="rating-row-single">
                    <div class="rating-item-ultra">
                        <span class="rating-label-ultra">üé® „Éá„Ç∂„Ç§„É≥</span>
                        <div class="rating-buttons-ultra" id="designRating"></div>
                    </div>
                    <div class="rating-item-ultra">
                        <span class="rating-label-ultra">‚öôÔ∏è Ê©üËÉΩÊÄß</span>
                        <div class="rating-buttons-ultra" id="functionalityRating"></div>
                    </div>
                    <div class="rating-item-ultra">
                        <span class="rating-label-ultra">üñ±Ô∏è ‰Ωø„ÅÑ„ÇÑ„Åô„Åï</span>
                        <div class="rating-buttons-ultra" id="usabilityRating"></div>
                    </div>
                    <div class="rating-item-ultra">
                        <span class="rating-label-ultra">‚ö° „Éë„Éï„Ç©„Éº„Éû„É≥„Çπ</span>
                        <div class="rating-buttons-ultra" id="performanceRating"></div>
                    </div>
                </div>
            </div>

            <div class="memo-section">
                <div class="memo-title">üìù „É°„É¢„ÉªÊÑüÊÉ≥</div>
                <textarea class="memo-textarea" id="memoTextarea" placeholder="„Åì„ÅÆ„Ç¢„Éó„É™„Å´„Å§„ÅÑ„Å¶„ÅÆÊÑüÊÉ≥„ÄÅÊîπÂñÑÁÇπ„ÄÅÊ∞ó„Å•„ÅÑ„Åü„Åì„Å®„Å™„Å©„ÇíËá™Áî±„Å´Ë®òÂÖ•„Åó„Å¶„Åè„Å†„Åï„ÅÑ..."></textarea>
            </div>


            <div class="button-section" style="margin-top: 10px;">
                <button class="btn" style="background: #3742fa; color: white; font-size: 0.8rem;" onclick="checkFirebaseData()">üîç FirebaseÁ¢∫Ë™ç</button>
                <button class="btn" style="background: #26d0ce; color: white; font-size: 0.8rem; margin-top: 5px;" onclick="showUpdateLogs()">üìã Êõ¥Êñ∞„É≠„Ç∞</button>
            </div>

            <div class="stats-section">
                <div class="stats-title">üìà „É¨„Éì„É•„ÉºÁµ±Ë®à</div>
                <div class="stats-item"><span>„É¨„Éì„É•„ÉºÊ∏à„Åø:</span><span id="reviewedCount">0ÂÄã</span></div>
                <div class="stats-item"><span>Âπ≥Âùá„Éá„Ç∂„Ç§„É≥:</span><span id="avgDesign">-</span></div>
                <div class="stats-item"><span>Âπ≥ÂùáÊ©üËÉΩÊÄß:</span><span id="avgFunctionality">-</span></div>
                <div class="stats-item"><span>Âπ≥Âùá„ÇØ„Ç§„ÉÉ„ÇØ:</span><span id="goodCount">-</span></div>
            </div>

            <div class="bottom-nav-section">
                <button class="bottom-nav-btn nav-prev" onclick="previousApp()">‚óÄ Ââç„Å∏</button>
                <button class="bottom-nav-btn nav-save" onclick="saveReview()">üíæ ‰øùÂ≠ò</button>
                <button class="bottom-nav-btn nav-next" onclick="nextApp()">Ê¨°„Å∏ ‚ñ∂</button>
            </div>
        </div>

        <div class="app-display">
            <div class="app-header-compact">
                <div class="app-title-line">
                    <div id="headerAppName">„Ç¢„Éó„É™Âêç</div>
                    <div class="app-url-line" id="headerAppUrl">URL</div>
                </div>
            </div>
            <div class="app-controls-bottom">
                <button class="control-btn-small" onclick="reloadApp()">üîÑ „É™„É≠„Éº„Éâ</button>
                <button class="control-btn-small" onclick="openInNewTab()">üîó Êñ∞„Åó„ÅÑ„Çø„Éñ„ÅßÈñã„Åè</button>
            </div>
            <div class="app-container">
                <div class="app-wrapper">
                    <iframe id="appFrame" class="app-frame" src="" sandbox="allow-scripts allow-same-origin allow-forms allow-popups allow-modals allow-popups-to-escape-sandbox"></iframe>
                </div>
            </div>
            <div class="app-status-bottom">
                <div class="app-status-text">„Çπ„ÉÜ„Éº„Çø„Çπ: <span id="appStatusDisplay">Ë™≠„ÅøËæº„Åø‰∏≠...</span></div>
            </div>
        </div>
    </div>

    <!-- Firebase SDKs (compatÁâà„Å´Â§âÊõ¥) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script>

        // üìã FirebaseË®≠ÂÆöÔºàshares-b1b97„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÔºâ
        const firebaseConfig = {
            apiKey: "AIzaSyA5PXKChizYDCXF_GJ4KL6Ylq9K5hCPXWE",
            authDomain: "shares-b1b97.firebaseapp.com",
            databaseURL: "https://shares-b1b97-default-rtdb.firebaseio.com",
            projectId: "shares-b1b97",
            storageBucket: "shares-b1b97.firebasestorage.app",
            messagingSenderId: "38311063248",
            appId: "1:38311063248:web:0d2d5726d12b305b24b8d5"
        };

        // FirebaseÂàùÊúüÂåñ
        let app, auth, db, database;
        let isFirebaseConnected = false;
        let currentUser = null;

        // „Ç∞„É≠„Éº„Éê„É´Â§âÊï∞
        let apps = [];
        let currentIndex = 0;
        let reviews = {};

        // FirebaseÂàùÊúüÂåñ„Å®„Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞Ôºàsimple-syncÊñπÂºè - Ë™çË®º„Å™„ÅóÔºâ
        try {
            firebase.initializeApp(firebaseConfig);
            database = firebase.database();
            isFirebaseConnected = true;
            console.log('üî• FirebaseÊé•Á∂öÊàêÂäü (Ë™çË®º„Å™„Åó„É¢„Éº„Éâ)');
            
            // Êé•Á∂öÁä∂ÊÖãÁõ£Ë¶ñÔºàsimple-syncÊñπÂºèÔºâ
            database.ref('.info/connected').on('value', (snap) => {
                const isOnline = snap.val() === true;
                const statusEl = document.getElementById('syncStatus');
                if (statusEl) {
                    statusEl.innerHTML = isOnline 
                        ? '<span class="sync-online">üü¢ „Ç™„É≥„É©„Ç§„É≥ÂêåÊúü</span>'
                        : '<span class="sync-offline">‚ö™ „Ç™„Éï„É©„Ç§„É≥</span>';
                }
            });
            
            // Ë™çË®º„Å™„Åó„ÅßÂç≥Â∫ß„Å´„Éá„Éº„ÇøË™≠„ÅøËæº„ÅøÈñãÂßã
            loadFirebaseReviews();
            
        } catch (error) {
            console.error('‚ùå FirebaseÊé•Á∂ö„Ç®„É©„Éº:', error);
            document.getElementById('syncStatus').innerHTML = '<span class="sync-offline">‚ö†Ô∏è FirebaseÊé•Á∂ö„Ç®„É©„Éº</span>';
        }

        // Ë™çË®ºÈñ¢Êï∞ÔºàGoogleË™çË®º„ÅÆ„Åø„ÄÅcompatÁâàÔºâ
        window.signInWithGoogle = async function() {
            if (!isFirebaseConnected) {
                alert('FirebaseÊé•Á∂ö„Ç®„É©„Éº„Åß„Åô„ÄÇ„Éö„Éº„Ç∏„Çí„É™„É≠„Éº„Éâ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                return;
            }

            const provider = new firebase.auth.GoogleAuthProvider();
            provider.addScope('profile');
            provider.addScope('email');
            
            try {
                const result = await auth.signInWithPopup(provider);
                console.log('‚úÖ GoogleË™çË®ºÊàêÂäü:', result.user.displayName);
                console.log('üì± „É™„Ç¢„É´„Çø„Ç§„É†ÂêåÊúü„ÅåÊúâÂäπ„Å´„Å™„Çä„Åæ„Åó„Åü');
            } catch (error) {
                console.error('‚ùå GoogleË™çË®º„Ç®„É©„Éº:', error);
                if (error.code === 'auth/popup-closed-by-user') {
                    alert('Ë™çË®º„Åå„Ç≠„É£„É≥„Çª„É´„Åï„Çå„Åæ„Åó„Åü');
                } else if (error.code === 'auth/popup-blocked') {
                    alert('„Éù„ÉÉ„Éó„Ç¢„ÉÉ„Éó„Åå„Éñ„É≠„ÉÉ„ÇØ„Åï„Çå„Åæ„Åó„Åü„ÄÇ„Éù„ÉÉ„Éó„Ç¢„ÉÉ„Éó„ÇíË®±ÂèØ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                } else {
                    alert('GoogleË™çË®º„Ç®„É©„Éº: ' + error.message);
                }
            }
        };

        window.signOut = async function() {
            if (!isFirebaseConnected) return;

            try {
                await auth.signOut();
                console.log('‚úÖ „É≠„Ç∞„Ç¢„Ç¶„ÉàÊàêÂäü');
            } catch (error) {
                console.error('‚ùå „É≠„Ç∞„Ç¢„Ç¶„Éà„Ç®„É©„Éº:', error);
            }
        };

        // Ë™çË®º„Å™„Åó„É¢„Éº„Éâ - Ë™çË®º„Çª„ÇØ„Ç∑„Éß„É≥„ÇíÈùûË°®Á§∫„Å´„Åó„Å¶Áõ¥Êé•ÈñãÂßã
        if (isFirebaseConnected) {
            document.getElementById('authSection').style.display = 'none';
            document.getElementById('userAppInfo').style.display = 'flex';
            document.getElementById('appInfoFallback').style.display = 'none';
            
            // ÂåøÂêç„É¶„Éº„Ç∂„Éº„Å®„Åó„Å¶Ë°®Á§∫
            document.getElementById('userDisplay').textContent = 'ÂåøÂêç„É¶„Éº„Ç∂„Éº (Ë™çË®º„Å™„Åó)';
            document.getElementById('userAvatar').style.display = 'none';
            
            console.log('üîÑ Ë™çË®º„Å™„Åó„É¢„Éº„Éâ„ÅßÂêåÊúüÈñãÂßã');
        }

        // Firebase„Åã„Çâ„É¨„Éì„É•„Éº„Éá„Éº„ÇøË™≠„ÅøËæº„ÅøÔºàË™çË®º„Å™„Åó„É¢„Éº„ÉâÔºâ
        async function loadFirebaseReviews() {
            if (!isFirebaseConnected) return;

            try {
                // Ë™çË®º„Å™„Åó„ÅßÂÖ±Êúâ„Éá„Éº„Çø„Éô„Éº„Çπ„Å´„Ç¢„ÇØ„Çª„ÇπÔºàsimple-syncÊñπÂºèÔºâ
                const reviewsRef = database.ref('app-reviews-shared');
                
                reviewsRef.on('value', (snapshot) => {
                    const data = snapshot.val() || {};
                    reviews = data;
                    console.log('üìä Firebase„É¨„Éì„É•„Éº„Éá„Éº„ÇøË™≠„ÅøËæº„ÅøÂÆå‰∫Ü:', Object.keys(reviews).length);
                    updateStats();
                    if (currentIndex >= 0) loadCurrentReview();
                });
            } catch (error) {
                console.error('‚ùå Firebase„É¨„Éì„É•„ÉºË™≠„ÅøËæº„Åø„Ç®„É©„Éº:', error);
            }
        }

        // Firebase„Å´„É¨„Éì„É•„Éº„Éá„Éº„Çø‰øùÂ≠òÔºàË™çË®º„Å™„Åó„É¢„Éº„ÉâÔºâ
        async function saveFirebaseReview(appName, reviewData) {
            if (!isFirebaseConnected) return false;

            try {
                const reviewDoc = {
                    appName: appName,
                    ...reviewData,
                    timestamp: new Date().toISOString(),
                    deviceInfo: navigator.userAgent,
                    sessionId: 'anonymous-' + Date.now()
                };

                await database.ref(`app-reviews-shared/${appName}`).set(reviewDoc);
                console.log('üíæ Firebase‰øùÂ≠òÊàêÂäü (Ë™çË®º„Å™„Åó):', appName);
                return true;
            } catch (error) {
                console.error('‚ùå Firebase‰øùÂ≠ò„Ç®„É©„Éº:', error);
                return false;
            }
        }

        // „Ç¢„Éó„É™„Éá„Éº„ÇøÔºàÂüã„ÇÅËæº„ÅøÁâà - CORSÂõûÈÅøÁî®Ôºâ
        const appData = {
          "timestamp": "2025-07-27T15:05:57.228Z",
          "repository": "muumuu8181/published-apps",
          "summary": {
            "total": 152,
            "accessible": 107,
            "inaccessible": 45,
            "successRate": 70.4
          },
          "apps": [
            {"appName": "app-0000001-297gku", "url": "https://muumuu8181.github.io/published-apps/app-0000001-297gku/", "status": 200, "accessible": true, "responseTime": 1262},
            {"appName": "app-0000001-2k6sxh", "url": "https://muumuu8181.github.io/published-apps/app-0000001-2k6sxh/", "status": 200, "accessible": true, "responseTime": 1261},
            {"appName": "app-0000001-34xzgi", "url": "https://muumuu8181.github.io/published-apps/app-0000001-34xzgi/", "status": 200, "accessible": true, "responseTime": 1262},
            {"appName": "app-0000001-3fmmt2", "url": "https://muumuu8181.github.io/published-apps/app-0000001-3fmmt2/", "status": 200, "accessible": true, "responseTime": 1257},
            {"appName": "app-0000001-44kiri", "url": "https://muumuu8181.github.io/published-apps/app-0000001-44kiri/", "status": 200, "accessible": true, "responseTime": 1254},
            {"appName": "app-0000001-4ijs4a", "url": "https://muumuu8181.github.io/published-apps/app-0000001-4ijs4a/", "status": 200, "accessible": true, "responseTime": 1254},
            {"appName": "app-0000001-6njwdc", "url": "https://muumuu8181.github.io/published-apps/app-0000001-6njwdc/", "status": 200, "accessible": true, "responseTime": 1252},
            {"appName": "app-0000001-78vfe5", "url": "https://muumuu8181.github.io/published-apps/app-0000001-78vfe5/", "status": 200, "accessible": true, "responseTime": 1249},
            {"appName": "app-0000001-7uibj5", "url": "https://muumuu8181.github.io/published-apps/app-0000001-7uibj5/", "status": 200, "accessible": true, "responseTime": 1250},
            {"appName": "app-0000001-87da9z", "url": "https://muumuu8181.github.io/published-apps/app-0000001-87da9z/", "status": 200, "accessible": true, "responseTime": 1247},
            {"appName": "app-0000001-9aejjc", "url": "https://muumuu8181.github.io/published-apps/app-0000001-9aejjc/", "status": 200, "accessible": true, "responseTime": 1246},
            {"appName": "app-0000001-bsczu4", "url": "https://muumuu8181.github.io/published-apps/app-0000001-bsczu4/", "status": 200, "accessible": true, "responseTime": 1251},
            {"appName": "app-0000001-cadpz7", "url": "https://muumuu8181.github.io/published-apps/app-0000001-cadpz7/", "status": 200, "accessible": true, "responseTime": 1245},
            {"appName": "app-0000001-dj6v83", "url": "https://muumuu8181.github.io/published-apps/app-0000001-dj6v83/", "status": 200, "accessible": true, "responseTime": 1242},
            {"appName": "app-0000001-ey24j7", "url": "https://muumuu8181.github.io/published-apps/app-0000001-ey24j7/", "status": 200, "accessible": true, "responseTime": 1243},
            {"appName": "app-0000001-gcvh9i", "url": "https://muumuu8181.github.io/published-apps/app-0000001-gcvh9i/", "status": 200, "accessible": true, "responseTime": 1243},
            {"appName": "app-0000001-hfkvcy", "url": "https://muumuu8181.github.io/published-apps/app-0000001-hfkvcy/", "status": 200, "accessible": true, "responseTime": 1241},
            {"appName": "app-0000001-hk5y4j", "url": "https://muumuu8181.github.io/published-apps/app-0000001-hk5y4j/", "status": 200, "accessible": true, "responseTime": 1239},
            {"appName": "app-0000001-jzh3gm", "url": "https://muumuu8181.github.io/published-apps/app-0000001-jzh3gm/", "status": 200, "accessible": true, "responseTime": 1237},
            {"appName": "app-0000001-mjgixu", "url": "https://muumuu8181.github.io/published-apps/app-0000001-mjgixu/", "status": 200, "accessible": true, "responseTime": 1236},
            {"appName": "app-0000001-pg4mcs", "url": "https://muumuu8181.github.io/published-apps/app-0000001-pg4mcs/", "status": 200, "accessible": true, "responseTime": 1235},
            {"appName": "app-0000001-qz5eeg", "url": "https://muumuu8181.github.io/published-apps/app-0000001-qz5eeg/", "status": 200, "accessible": true, "responseTime": 1234},
            {"appName": "app-0000001-twcf8h", "url": "https://muumuu8181.github.io/published-apps/app-0000001-twcf8h/", "status": 200, "accessible": true, "responseTime": 1233},
            {"appName": "app-0000001-wh29mt", "url": "https://muumuu8181.github.io/published-apps/app-0000001-wh29mt/", "status": 200, "accessible": true, "responseTime": 1234},
            {"appName": "app-0000001-z8kycr", "url": "https://muumuu8181.github.io/published-apps/app-0000001-z8kycr/", "status": 200, "accessible": true, "responseTime": 1232},
            {"appName": "app-00000014-37644l5uh", "url": "https://muumuu8181.github.io/published-apps/app-00000014-37644l5uh/", "status": 200, "accessible": true, "responseTime": 1231},
            {"appName": "app-00000015-37037qtvt", "url": "https://muumuu8181.github.io/published-apps/app-00000015-37037qtvt/", "status": 200, "accessible": true, "responseTime": 1231},
            {"appName": "app-00000016-35196hxja", "url": "https://muumuu8181.github.io/published-apps/app-00000016-35196hxja/", "status": 200, "accessible": true, "responseTime": 1229},
            {"appName": "app-0000002-4ghvmz", "url": "https://muumuu8181.github.io/published-apps/app-0000002-4ghvmz/", "status": 200, "accessible": true, "responseTime": 1228},
            {"appName": "app-0000002-6992ec", "url": "https://muumuu8181.github.io/published-apps/app-0000002-6992ec/", "status": 200, "accessible": true, "responseTime": 1227},
            {"appName": "app-0000002-9ai2mz", "url": "https://muumuu8181.github.io/published-apps/app-0000002-9ai2mz/", "status": 200, "accessible": true, "responseTime": 1227},
            {"appName": "app-0000002-asnmhg", "url": "https://muumuu8181.github.io/published-apps/app-0000002-asnmhg/", "status": 200, "accessible": true, "responseTime": 1226},
            {"appName": "app-0000002-b5298s", "url": "https://muumuu8181.github.io/published-apps/app-0000002-b5298s/", "status": 200, "accessible": true, "responseTime": 1213},
            {"appName": "app-0000002-gzcxia", "url": "https://muumuu8181.github.io/published-apps/app-0000002-gzcxia/", "status": 200, "accessible": true, "responseTime": 1212},
            {"appName": "app-0000002-jvi6gp", "url": "https://muumuu8181.github.io/published-apps/app-0000002-jvi6gp/", "status": 200, "accessible": true, "responseTime": 1210},
            {"appName": "app-0000003-9cr3vy", "url": "https://muumuu8181.github.io/published-apps/app-0000003-9cr3vy/", "status": 200, "accessible": true, "responseTime": 1208},
            {"appName": "app-0000003-nttm2g", "url": "https://muumuu8181.github.io/published-apps/app-0000003-nttm2g/", "status": 200, "accessible": true, "responseTime": 1206},
            {"appName": "app-0000003-pybb34", "url": "https://muumuu8181.github.io/published-apps/app-0000003-pybb34/", "status": 200, "accessible": true, "responseTime": 1205},
            {"appName": "app-0000003-qxhvcj", "url": "https://muumuu8181.github.io/published-apps/app-0000003-qxhvcj/", "status": 200, "accessible": true, "responseTime": 1199},
            {"appName": "app-0000003-xdrim4", "url": "https://muumuu8181.github.io/published-apps/app-0000003-xdrim4/", "status": 200, "accessible": true, "responseTime": 1196},
            {"appName": "app-0000004-d9j7b6", "url": "https://muumuu8181.github.io/published-apps/app-0000004-d9j7b6/", "status": 200, "accessible": true, "responseTime": 1181},
            {"appName": "app-0000004-gfwxag", "url": "https://muumuu8181.github.io/published-apps/app-0000004-gfwxag/", "status": 200, "accessible": true, "responseTime": 1182},
            {"appName": "app-0000004-pqtec8", "url": "https://muumuu8181.github.io/published-apps/app-0000004-pqtec8/", "status": 200, "accessible": true, "responseTime": 1180},
            {"appName": "app-0000004-wssf74", "url": "https://muumuu8181.github.io/published-apps/app-0000004-wssf74/", "status": 200, "accessible": true, "responseTime": 1179},
            {"appName": "app-00000040-gtqty9", "url": "https://muumuu8181.github.io/published-apps/app-00000040-gtqty9/", "status": 200, "accessible": true, "responseTime": 1176},
            {"appName": "app-0000005-68637", "url": "https://muumuu8181.github.io/published-apps/app-0000005-68637/", "status": 200, "accessible": true, "responseTime": 1176},
            {"appName": "app-0000005-pcgmr5", "url": "https://muumuu8181.github.io/published-apps/app-0000005-pcgmr5/", "status": 200, "accessible": true, "responseTime": 1172},
            {"appName": "app-0000005-q594nt", "url": "https://muumuu8181.github.io/published-apps/app-0000005-q594nt/", "status": 200, "accessible": true, "responseTime": 1172},
            {"appName": "app-0000006-bamb00", "url": "https://muumuu8181.github.io/published-apps/app-0000006-bamb00/", "status": 200, "accessible": true, "responseTime": 1169},
            {"appName": "app-0000006-vvdeak", "url": "https://muumuu8181.github.io/published-apps/app-0000006-vvdeak/", "status": 200, "accessible": true, "responseTime": 1166},
            {"appName": "app-0000012-v55yyb", "url": "https://muumuu8181.github.io/published-apps/app-0000012-v55yyb/", "status": 200, "accessible": true, "responseTime": 1149},
            {"appName": "app-0000013-26a2qi", "url": "https://muumuu8181.github.io/published-apps/app-0000013-26a2qi/", "status": 200, "accessible": true, "responseTime": 1149},
            {"appName": "app-0000013-36314korg", "url": "https://muumuu8181.github.io/published-apps/app-0000013-36314korg/", "status": 200, "accessible": true, "responseTime": 1148},
            {"appName": "app-0000016-ixr5jz", "url": "https://muumuu8181.github.io/published-apps/app-0000016-ixr5jz/", "status": 200, "accessible": true, "responseTime": 1151},
            {"appName": "app-0000017-k7x9m2", "url": "https://muumuu8181.github.io/published-apps/app-0000017-k7x9m2/", "status": 200, "accessible": true, "responseTime": 1147},
            {"appName": "app-0000018-m9x3k2", "url": "https://muumuu8181.github.io/published-apps/app-0000018-m9x3k2/", "status": 200, "accessible": true, "responseTime": 1147},
            {"appName": "app-0000019-x7k9p3", "url": "https://muumuu8181.github.io/published-apps/app-0000019-x7k9p3/", "status": 200, "accessible": true, "responseTime": 1144},
            {"appName": "app-0000020-y8m5n4", "url": "https://muumuu8181.github.io/published-apps/app-0000020-y8m5n4/", "status": 200, "accessible": true, "responseTime": 1140},
            {"appName": "app-0000021-r5x8k2", "url": "https://muumuu8181.github.io/published-apps/app-0000021-r5x8k2/", "status": 200, "accessible": true, "responseTime": 1131},
            {"appName": "app-0000022-w9p4n6", "url": "https://muumuu8181.github.io/published-apps/app-0000022-w9p4n6/", "status": 200, "accessible": true, "responseTime": 1129},
            {"appName": "app-0000023-t2m7q1", "url": "https://muumuu8181.github.io/published-apps/app-0000023-t2m7q1/", "status": 200, "accessible": true, "responseTime": 1128},
            {"appName": "app-0000024-x5k8m3", "url": "https://muumuu8181.github.io/published-apps/app-0000024-x5k8m3/", "status": 200, "accessible": true, "responseTime": 1126},
            {"appName": "app-0000025-g3n7k9", "url": "https://muumuu8181.github.io/published-apps/app-0000025-g3n7k9/", "status": 200, "accessible": true, "responseTime": 1123},
            {"appName": "app-0000026-j2m8r5", "url": "https://muumuu8181.github.io/published-apps/app-0000026-j2m8r5/", "status": 200, "accessible": true, "responseTime": 1121},
            {"appName": "app-0000027-p7x2n9", "url": "https://muumuu8181.github.io/published-apps/app-0000027-p7x2n9/", "status": 200, "accessible": true, "responseTime": 1118},
            {"appName": "app-0000028-k5m8w3", "url": "https://muumuu8181.github.io/published-apps/app-0000028-k5m8w3/", "status": 200, "accessible": true, "responseTime": 1114},
            {"appName": "app-0000029-t9r4j6", "url": "https://muumuu8181.github.io/published-apps/app-0000029-t9r4j6/", "status": 200, "accessible": true, "responseTime": 1113},
            {"appName": "app-0000030-q7d5p2", "url": "https://muumuu8181.github.io/published-apps/app-0000030-q7d5p2/", "status": 200, "accessible": true, "responseTime": 1109},
            {"appName": "app-0000040-nhg4sa", "url": "https://muumuu8181.github.io/published-apps/app-0000040-nhg4sa/", "status": 200, "accessible": true, "responseTime": 1104},
            {"appName": "app-001-2ba5vb", "url": "https://muumuu8181.github.io/published-apps/app-001-2ba5vb/", "status": 200, "accessible": true, "responseTime": 1105},
            {"appName": "app-001-7g5f2h", "url": "https://muumuu8181.github.io/published-apps/app-001-7g5f2h/", "status": 200, "accessible": true, "responseTime": 1103},
            {"appName": "app-001-9445m7", "url": "https://muumuu8181.github.io/published-apps/app-001-9445m7/", "status": 200, "accessible": true, "responseTime": 1101},
            {"appName": "app-001-auctrh", "url": "https://muumuu8181.github.io/published-apps/app-001-auctrh/", "status": 200, "accessible": true, "responseTime": 1100},
            {"appName": "app-001-c5qw5s", "url": "https://muumuu8181.github.io/published-apps/app-001-c5qw5s/", "status": 200, "accessible": true, "responseTime": 1099},
            {"appName": "app-001-cunsq6", "url": "https://muumuu8181.github.io/published-apps/app-001-cunsq6/", "status": 200, "accessible": true, "responseTime": 1098},
            {"appName": "app-001-cw7bpy", "url": "https://muumuu8181.github.io/published-apps/app-001-cw7bpy/", "status": 200, "accessible": true, "responseTime": 1098},
            {"appName": "app-001-f24wut", "url": "https://muumuu8181.github.io/published-apps/app-001-f24wut/", "status": 200, "accessible": true, "responseTime": 1096},
            {"appName": "app-001-ffuw7m", "url": "https://muumuu8181.github.io/published-apps/app-001-ffuw7m/", "status": 200, "accessible": true, "responseTime": 1096},
            {"appName": "app-001-gpie24", "url": "https://muumuu8181.github.io/published-apps/app-001-gpie24/", "status": 200, "accessible": true, "responseTime": 1115},
            {"appName": "app-001-md6m7t", "url": "https://muumuu8181.github.io/published-apps/app-001-md6m7t/", "status": 200, "accessible": true, "responseTime": 1122},
            {"appName": "app-001-nmbiyr", "url": "https://muumuu8181.github.io/published-apps/app-001-nmbiyr/", "status": 200, "accessible": true, "responseTime": 1119},
            {"appName": "app-001-r4keva", "url": "https://muumuu8181.github.io/published-apps/app-001-r4keva/", "status": 200, "accessible": true, "responseTime": 1145},
            {"appName": "app-001-skbky7", "url": "https://muumuu8181.github.io/published-apps/app-001-skbky7/", "status": 200, "accessible": true, "responseTime": 1089},
            {"appName": "app-001-sqnkjv", "url": "https://muumuu8181.github.io/published-apps/app-001-sqnkjv/", "status": 200, "accessible": true, "responseTime": 1143},
            {"appName": "app-001-w4px6m", "url": "https://muumuu8181.github.io/published-apps/app-001-w4px6m/", "status": 200, "accessible": true, "responseTime": 1162},
            {"appName": "app-001-yu4hsr", "url": "https://muumuu8181.github.io/published-apps/app-001-yu4hsr/", "status": 200, "accessible": true, "responseTime": 1115},
            {"appName": "app-002-7k55w2", "url": "https://muumuu8181.github.io/published-apps/app-002-7k55w2/", "status": 200, "accessible": true, "responseTime": 1229},
            {"appName": "app-002-m5si46", "url": "https://muumuu8181.github.io/published-apps/app-002-m5si46/", "status": 200, "accessible": true, "responseTime": 1102},
            {"appName": "app-003-thqdtb", "url": "https://muumuu8181.github.io/published-apps/app-003-thqdtb/", "status": 200, "accessible": true, "responseTime": 1135},
            {"appName": "app-003-v6z6mv", "url": "https://muumuu8181.github.io/published-apps/app-003-v6z6mv/", "status": 200, "accessible": true, "responseTime": 1099},
            {"appName": "app-004-383f9j", "url": "https://muumuu8181.github.io/published-apps/app-004-383f9j/", "status": 200, "accessible": true, "responseTime": 1099},
            {"appName": "app-004-8in9a7", "url": "https://muumuu8181.github.io/published-apps/app-004-8in9a7/", "status": 200, "accessible": true, "responseTime": 1135},
            {"appName": "app-004-8zhmt8", "url": "https://muumuu8181.github.io/published-apps/app-004-8zhmt8/", "status": 200, "accessible": true, "responseTime": 1076},
            {"appName": "app-004-eb82au", "url": "https://muumuu8181.github.io/published-apps/app-004-eb82au/", "status": 200, "accessible": true, "responseTime": 1120},
            {"appName": "app-004-puzcnd", "url": "https://muumuu8181.github.io/published-apps/app-004-puzcnd/", "status": 200, "accessible": true, "responseTime": 1072},
            {"appName": "app-004-uujaea", "url": "https://muumuu8181.github.io/published-apps/app-004-uujaea/", "status": 200, "accessible": true, "responseTime": 1145},
            {"appName": "app-005-4hgqve", "url": "https://muumuu8181.github.io/published-apps/app-005-4hgqve/", "status": 200, "accessible": true, "responseTime": 1145},
            {"appName": "app-005-ar94ux", "url": "https://muumuu8181.github.io/published-apps/app-005-ar94ux/", "status": 200, "accessible": true, "responseTime": 1152},
            {"appName": "app-005-cwmucx", "url": "https://muumuu8181.github.io/published-apps/app-005-cwmucx/", "status": 200, "accessible": true, "responseTime": 1151},
            {"appName": "app-006-izhq8x", "url": "https://muumuu8181.github.io/published-apps/app-006-izhq8x/", "status": 200, "accessible": true, "responseTime": 1166},
            {"appName": "app-007-aq86rj", "url": "https://muumuu8181.github.io/published-apps/app-007-aq86rj/", "status": 200, "accessible": true, "responseTime": 1156},
            {"appName": "app-011-qciksk", "url": "https://muumuu8181.github.io/published-apps/app-011-qciksk/", "status": 200, "accessible": true, "responseTime": 1174},
            {"appName": "app-012-7eyvn6", "url": "https://muumuu8181.github.io/published-apps/app-012-7eyvn6/", "status": 200, "accessible": true, "responseTime": 1210},
            {"appName": "app-012-hy9x2k", "url": "https://muumuu8181.github.io/published-apps/app-012-hy9x2k/", "status": 200, "accessible": true, "responseTime": 1191},
            {"appName": "app-013-kyg9mx", "url": "https://muumuu8181.github.io/published-apps/app-013-kyg9mx/", "status": 200, "accessible": true, "responseTime": 1202},
            {"appName": "app-013-vtwbau", "url": "https://muumuu8181.github.io/published-apps/app-013-vtwbau/", "status": 200, "accessible": true, "responseTime": 1222},
            {"appName": "app-013-wx7f4g", "url": "https://muumuu8181.github.io/published-apps/app-013-wx7f4g/", "status": 200, "accessible": true, "responseTime": 1187}
          ]
        };

        // ÂàùÊúüÂåñ
        async function init() {
            try {
                console.log('üöÄ „É¨„Éì„É•„Éº„ÉÑ„Éº„É´ÂàùÊúüÂåñÈñãÂßã...');
                
                // „Ç¢„Éó„É™„Éá„Éº„ÇøË™≠„ÅøËæº„Åø
                let data;
                try {
                    const response = await fetch('./data.json');
                    if (response.ok) {
                        data = await response.json();
                        console.log('üìã data.jsonË™≠„ÅøËæº„ÅøÊàêÂäü:', data.summary);
                    } else {
                        throw new Error('data.jsonË™≠„ÅøËæº„ÅøÂ§±Êïó');
                    }
                } catch (error) {
                    console.error('‚ùå data.jsonË™≠„ÅøËæº„Åø„Ç®„É©„Éº:', error);
                    console.log('üìã Âüã„ÇÅËæº„Åø„Éá„Éº„Çø„Çí‰ΩøÁî®„Åó„Åæ„Åô');
                    data = appData;
                }
                
                if (!data.apps || !Array.isArray(data.apps)) {
                    throw new Error('„Ç¢„Éó„É™„Éá„Éº„Çø„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì');
                }
                
                apps = data.apps.filter(app => app.accessible === true);
                console.log(`üì± ${apps.length}ÂÄã„ÅÆ„Ç¢„ÇØ„Çª„ÇπÂèØËÉΩ„Å™„Ç¢„Éó„É™„ÇíË™≠„ÅøËæº„Åø„Åæ„Åó„Åü`);
                
                if (apps.length === 0) {
                    throw new Error('„Ç¢„ÇØ„Çª„ÇπÂèØËÉΩ„Å™„Ç¢„Éó„É™„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì');
                }
                
                loadReviews();
                initRatingButtons();
                showApp(0);
                
            } catch (error) {
                console.error('‚ùå ÂàùÊúüÂåñ„Ç®„É©„Éº:', error);
                document.getElementById('currentAppName').textContent = '„Ç®„É©„Éº: ' + error.message;
                document.getElementById('currentAppNameFallback').textContent = '„Ç®„É©„Éº: ' + error.message;
                document.getElementById('progressText').textContent = '„Éá„Éº„ÇøË™≠„ÅøËæº„ÅøÂ§±Êïó';
            }
        }

        // Ë©ï‰æ°„Éú„Çø„É≥ÂàùÊúüÂåñ
        function initRatingButtons() {
            const categories = ['designRating', 'functionalityRating', 'usabilityRating', 'performanceRating'];
            categories.forEach(category => {
                const container = document.getElementById(category);
                container.innerHTML = '';
                for (let i = 1; i <= 10; i++) {
                    const btn = document.createElement('button');
                    btn.className = 'rating-btn';
                    btn.textContent = i;
                    btn.onclick = () => setRating(category, i);
                    container.appendChild(btn);
                }
            });
        }

        // Ë©ï‰æ°Ë®≠ÂÆö
        function setRating(category, value) {
            playButtonSound('click');
            
            const container = document.getElementById(category);
            const buttons = container.querySelectorAll('.rating-btn');
            buttons.forEach((btn, index) => {
                if (index + 1 <= value) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            const appId = apps[currentIndex].appName;
            if (!reviews[appId]) reviews[appId] = {};
            reviews[appId][category.replace('Rating', '')] = value;
        }

        // „ÇØ„Ç§„ÉÉ„ÇØË©ï‰æ°
        window.quickRating = function(rating) {
            playButtonSound('click');
            
            const appId = apps[currentIndex].appName;
            if (!reviews[appId]) reviews[appId] = {};
            reviews[appId].quickRating = rating;
            
            // „Éú„Çø„É≥„ÅÆ„Ç¢„ÇØ„ÉÜ„Ç£„ÉñÁä∂ÊÖã„ÇíÊõ¥Êñ∞
            document.querySelectorAll('.quick-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        };

        // „Ç¢„Éó„É™Ë°®Á§∫
        function showApp(index) {
            if (index < 0 || index >= apps.length) return;
            
            currentIndex = index;
            const app = apps[index];
            
            document.getElementById('currentAppName').textContent = app.appName;
            document.getElementById('currentAppStatus').textContent = `Áä∂ÊÖã: ${app.status} | ÂøúÁ≠îÊôÇÈñì: ${app.responseTime}ms`;
            document.getElementById('currentAppNameFallback').textContent = app.appName;
            document.getElementById('currentAppStatusFallback').textContent = `Áä∂ÊÖã: ${app.status} | ÂøúÁ≠îÊôÇÈñì: ${app.responseTime}ms`;
            document.getElementById('headerAppName').textContent = app.appName;
            document.getElementById('headerAppUrl').textContent = app.url;
            document.getElementById('appStatusDisplay').textContent = `${app.status} | ${app.responseTime}ms`;
            
            const progress = ((index + 1) / apps.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressText').textContent = `${index + 1} / ${apps.length} ÂÆå‰∫Ü`;
            
            const iframe = document.getElementById('appFrame');
            iframe.src = app.url;
            
            loadCurrentReview();
            updateStats();
        }

        // ÁèæÂú®„ÅÆ„É¨„Éì„É•„ÉºË™≠„ÅøËæº„Åø
        function loadCurrentReview() {
            const appId = apps[currentIndex].appName;
            const review = reviews[appId] || {};
            
            ['design', 'functionality', 'usability', 'performance'].forEach(category => {
                if (review[category]) {
                    setRating(category + 'Rating', review[category]);
                } else {
                    document.getElementById(category + 'Rating').querySelectorAll('.rating-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                }
            });
            
            document.getElementById('memoTextarea').value = review.memo || '';
            
            document.querySelectorAll('.quick-btn').forEach(btn => btn.classList.remove('active'));
            if (review.quickRating) {
                const quickBtns = document.querySelectorAll('.quick-btn');
                quickBtns.forEach((btn, index) => {
                    if (index + 1 === review.quickRating) {
                        btn.classList.add('active');
                    }
                });
            }
        }

        // Èü≥Â£∞„Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØÁî®Èñ¢Êï∞
        function playButtonSound(type = 'click') {
            try {
                // Web Audio API „Åß„Éì„Éº„ÉóÈü≥„ÇíÁîüÊàê
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                // Èü≥„ÅÆÁ®ÆÈ°û„Å´Âøú„Åò„Å¶Âë®Ê≥¢Êï∞„ÇíÂ§âÊõ¥
                switch(type) {
                    case 'save':
                        oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                        break;
                    case 'success':
                        oscillator.frequency.setValueAtTime(1000, audioContext.currentTime);
                        oscillator.frequency.setValueAtTime(1200, audioContext.currentTime + 0.1);
                        break;
                    case 'error':
                        oscillator.frequency.setValueAtTime(300, audioContext.currentTime);
                        break;
                    default:
                        oscillator.frequency.setValueAtTime(600, audioContext.currentTime);
                }
                
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.2);
            } catch (error) {
                console.log('üîá Èü≥Â£∞ÂÜçÁîü„Çí„Çπ„Ç≠„ÉÉ„Éó„Åó„Åæ„Åó„ÅüÔºàÈùûÂØæÂøúÁí∞Â¢ÉÔºâ');
            }
        }

        // „É¨„Éì„É•„Éº‰øùÂ≠òÔºàË™çË®º„Å™„Åó„É¢„Éº„ÉâÔºâ
        window.saveReview = async function() {
            playButtonSound('save');
            
            const appId = apps[currentIndex].appName;
            if (!reviews[appId]) reviews[appId] = {};
            reviews[appId].memo = document.getElementById('memoTextarea').value;
            reviews[appId].timestamp = new Date().toISOString();
            
            const saveBtn = document.querySelector('.bottom-nav-btn.nav-save');
            const originalText = saveBtn.textContent;
            const originalClass = saveBtn.className;
            
            // ‰øùÂ≠ò‰∏≠„ÅÆË¶ñË¶öÁöÑ„Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØ
            saveBtn.textContent = 'üîÑ ÂêåÊúü‰∏≠...';
            saveBtn.className = originalClass + ' saving';
            
            try {
                // Firebase‰øùÂ≠òÔºà„É™„Ç¢„É´„Çø„Ç§„É†ÂêåÊúüÔºâ
                const success = await saveFirebaseReview(appId, reviews[appId]);
                
                if (success) {
                    // ÊàêÂäü„Ç®„Éï„Çß„ÇØ„Éà
                    saveBtn.textContent = '‚úÖ ÂêåÊúüÂÆå‰∫Ü';
                    saveBtn.className = originalClass + ' success';
                    playButtonSound('success');
                    console.log('üì± ‰ªñ„ÅÆ„Éá„Éê„Ç§„Çπ„Å´Ëá™ÂãïÂêåÊúü„Åï„Çå„Åæ„Åó„Åü');
                    
                    // „É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„Å´„ÇÇ„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó‰øùÂ≠ò
                    localStorage.setItem('appReviews', JSON.stringify(reviews));
                } else {
                    throw new Error('Firebase‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                }
            } catch (error) {
                // „Ç®„É©„Éº„Ç®„Éï„Çß„ÇØ„Éà
                saveBtn.textContent = '‚ùå ÂêåÊúü„Ç®„É©„Éº';
                saveBtn.className = originalClass + ' error';
                playButtonSound('error');
                console.error('‰øùÂ≠ò„Ç®„É©„Éº:', error);
                
                // „Ç®„É©„ÉºÊôÇ„Åß„ÇÇ„É≠„Éº„Ç´„É´„Å´„ÅØ‰øùÂ≠ò
                localStorage.setItem('appReviews', JSON.stringify(reviews));
            }
            
            // 1.5ÁßíÂæå„Å´ÂÖÉ„ÅÆÁä∂ÊÖã„Å´Êàª„Çã
            setTimeout(() => {
                saveBtn.textContent = originalText;
                saveBtn.className = originalClass;
            }, 1500);
            
            updateStats();
        };

        // „É≠„Éº„Ç´„É´„É¨„Éì„É•„ÉºË™≠„ÅøËæº„ÅøÔºàË™çË®º„Å™„Åó„É¢„Éº„Éâ - „Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„ÉóÁî®Ôºâ
        function loadReviews() {
            // Ë™çË®º„Å™„Åó„É¢„Éº„Éâ„Åß„ÅØFirebase„É°„Ç§„É≥„Å†„Åå„ÄÅ„É≠„Éº„Ç´„É´„Çí„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„Å®„Åó„Å¶‰ΩøÁî®
            const saved = localStorage.getItem('appReviews');
            if (saved) {
                try {
                    const localReviews = JSON.parse(saved);
                    console.log('üìÇ „É≠„Éº„Ç´„É´„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„Éá„Éº„Çø„ÇíÂèÇÁÖß');
                    // Firebase„Éá„Éº„Çø„ÅåÁ©∫„ÅÆÂ†¥Âêà„ÅÆ„Åø„É≠„Éº„Ç´„É´„Éá„Éº„Çø„Çí‰ΩøÁî®
                    if (Object.keys(reviews).length === 0) {
                        reviews = localReviews;
                    }
                } catch (error) {
                    console.error('‚ùå „É≠„Éº„Ç´„É´„É¨„Éì„É•„Éº„Éá„Éº„ÇøË™≠„ÅøËæº„Åø„Ç®„É©„Éº:', error);
                }
            }
        }

        // Áµ±Ë®àÊõ¥Êñ∞
        function updateStats() {
            const reviewedApps = Object.keys(reviews).filter(appId => 
                reviews[appId].memo || reviews[appId].design || reviews[appId].quickRating
            );
            
            document.getElementById('reviewedCount').textContent = reviewedApps.length + 'ÂÄã';
            
            const avgDesign = calculateAverage('design');
            const avgFunc = calculateAverage('functionality');
            
            document.getElementById('avgDesign').textContent = avgDesign ? avgDesign.toFixed(1) + 'ÁÇπ' : '-';
            document.getElementById('avgFunctionality').textContent = avgFunc ? avgFunc.toFixed(1) + 'ÁÇπ' : '-';
            
            const avgQuick = reviewedApps.reduce((sum, appId) => sum + (reviews[appId].quickRating || 0), 0) / reviewedApps.length;
            document.getElementById('goodCount').textContent = avgQuick ? avgQuick.toFixed(1) + 'ÁÇπ' : '-';
        }

        // Âπ≥ÂùáË®àÁÆó
        function calculateAverage(category) {
            const values = Object.values(reviews).map(review => review[category]).filter(value => value);
            if (values.length === 0) return null;
            return values.reduce((sum, value) => sum + value, 0) / values.length;
        }

        // Firebase „Éá„Éº„ÇøÁ¢∫Ë™çÔºàË™çË®º„Å™„Åó„É¢„Éº„ÉâÔºâ
        window.checkFirebaseData = async function() {
            playButtonSound('click');
            try {
                const reviewsRef = database.ref('app-reviews-shared');
                const snapshot = await reviewsRef.once('value');
                const data = snapshot.val() || {};
                
                let message = `üìä Firebase„Éá„Éº„ÇøÁ¢∫Ë™çÁµêÊûú (Ë™çË®º„Å™„Åó„É¢„Éº„Éâ):\n\n`;
                message += `üë§ „É¶„Éº„Ç∂„Éº: ÂåøÂêç„É¶„Éº„Ç∂„Éº\n`;
                message += `üìù ‰øùÂ≠òÊ∏à„Åø„É¨„Éì„É•„Éº: ${Object.keys(data).length}‰ª∂\n\n`;
                
                if (Object.keys(data).length > 0) {
                    Object.entries(data).forEach(([appName, reviewData]) => {
                        message += `üî∏ ${appName}\n`;
                        if (reviewData.quickRating) message += `  ‚ö° „ÇØ„Ç§„ÉÉ„ÇØ: ${reviewData.quickRating}ÁÇπ\n`;
                        if (reviewData.memo) message += `  üìù „É°„É¢: ${reviewData.memo.substring(0, 30)}...\n`;
                        message += `  üïí Êõ¥Êñ∞: ${new Date(reviewData.timestamp).toLocaleString()}\n\n`;
                    });
                } else {
                    message += `‚ùå „Éá„Éº„Çø„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì\n`;
                    message += `üí° „É¨„Éì„É•„Éº„Çí‰øùÂ≠ò„Åó„Å¶„Åã„ÇâÂÜçÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ`;
                }
                
                alert(message);
            } catch (error) {
                console.error('‚ùå FirebaseÁ¢∫Ë™ç„Ç®„É©„Éº:', error);
                alert(`‚ùå FirebaseÁ¢∫Ë™ç„Ç®„É©„Éº:\n${error.message}`);
            }
        };

        // Êõ¥Êñ∞„É≠„Ç∞Ë°®Á§∫
        window.showUpdateLogs = async function() {
            playButtonSound('click');
            try {
                // GitHub API „ÅßÊúÄÊñ∞„ÅÆÂÆüË°å„É≠„Ç∞„ÇíÂèñÂæó
                const response = await fetch('https://api.github.com/repos/muumuu8181/firebase-app-reviewer/actions/workflows/update-data.yml/runs?per_page=5');
                const data = await response.json();
                
                let message = `üìã data.json Ëá™ÂãïÊõ¥Êñ∞„É≠„Ç∞:\n\n`;
                
                if (data.workflow_runs && data.workflow_runs.length > 0) {
                    data.workflow_runs.forEach((run, index) => {
                        const date = new Date(run.created_at).toLocaleString('ja-JP');
                        const status = run.conclusion === 'success' ? '‚úÖ' : 
                                     run.conclusion === 'failure' ? '‚ùå' : 'üîÑ';
                        const trigger = run.event === 'schedule' ? '‚è∞Ëá™ÂãïÂÆüË°å' :
                                       run.event === 'workflow_dispatch' ? 'üë§ÊâãÂãïÂÆüË°å' :
                                       run.event === 'repository_dispatch' ? 'üÜï„Ç§„Éô„É≥„ÉàÈßÜÂãï' : run.event;
                        
                        message += `${index + 1}. ${status} ${date}\n`;
                        message += `   „Éà„É™„Ç¨„Éº: ${trigger}\n`;
                        message += `   ÂÆüË°åÊôÇÈñì: ${Math.round((new Date(run.updated_at) - new Date(run.created_at)) / 1000)}Áßí\n\n`;
                    });
                } else {
                    message += `üìù ÂÆüË°åÂ±•Ê≠¥„Åå„ÅÇ„Çä„Åæ„Åõ„Çì\n`;
                    message += `üí° GitHub Actions „ÅåÂÆüË°å„Åï„Çå„Çã„Å®„Åì„Åì„Å´„É≠„Ç∞„ÅåË°®Á§∫„Åï„Çå„Åæ„Åô`;
                }
                
                message += `\nüîó Ë©≥Á¥∞„É≠„Ç∞: GitHub > Actions „Çø„Éñ„ÅßÁ¢∫Ë™ç`;
                alert(message);
                
            } catch (error) {
                console.error('‚ùå „É≠„Ç∞ÂèñÂæó„Ç®„É©„Éº:', error);
                alert(`‚ùå „É≠„Ç∞ÂèñÂæó„Ç®„É©„Éº:\n${error.message}\n\nüí° GitHub API „ÅÆÂà∂Èôê„Å´„Çà„Çä„É≠„Ç∞„ÇíÂèñÂæó„Åß„Åç„Åæ„Åõ„Çì„Åß„Åó„Åü`);
            }
        };

        // „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥
        window.nextApp = function() {
            playButtonSound('click');
            if (currentIndex < apps.length - 1) {
                showApp(currentIndex + 1);
            } else {
                alert('üéâ ÊúÄÂæå„ÅÆ„Ç¢„Éó„É™„Åß„ÅôÔºÅ„ÅäÁñ≤„Çå„Åï„Åæ„Åß„Åó„Åü„ÄÇ');
            }
        };

        window.previousApp = function() {
            playButtonSound('click');
            if (currentIndex > 0) {
                showApp(currentIndex - 1);
            } else {
                alert('üìç ÊúÄÂàù„ÅÆ„Ç¢„Éó„É™„Åß„Åô„ÄÇ');
            }
        };

        // „Ç¢„Éó„É™Âà∂Âæ°
        window.reloadApp = function() {
            playButtonSound('click');
            const iframe = document.getElementById('appFrame');
            iframe.src = iframe.src;
        };

        window.openInNewTab = function() {
            playButtonSound('click');
            window.open(apps[currentIndex].url, '_blank');
        };

        // „Ç≠„Éº„Éú„Éº„Éâ„Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà
        document.addEventListener('keydown', (e) => {
            if (e.target.tagName === 'TEXTAREA' || e.target.tagName === 'INPUT') return;
            
            switch(e.key) {
                case 'ArrowRight':
                case 'n':
                    e.preventDefault();
                    nextApp();
                    break;
                case 'ArrowLeft':
                case 'p':
                    e.preventDefault();
                    previousApp();
                    break;
                case 's':
                    if (e.ctrlKey) {
                        e.preventDefault();
                        saveReview();
                    }
                    break;
                case 'r':
                    if (e.ctrlKey) {
                        e.preventDefault();
                        reloadApp();
                    }
                    break;
            }
        });

        // ÂàùÊúüÂåñÂÆüË°å
        init();
    </script>
</body>
</html>