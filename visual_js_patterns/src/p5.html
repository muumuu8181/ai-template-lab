<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>p5.js „Éá„É¢ - Visual JS Patterns</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0a0a;
            color: #ffffff;
            overflow: hidden;
        }

        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .controls {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(26, 26, 46, 0.9);
            padding: 20px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            z-index: 100;
        }

        .controls h2 {
            margin-bottom: 15px;
            color: #4facfe;
        }

        .control-group {
            margin-bottom: 15px;
        }

        .control-group label {
            display: block;
            margin-bottom: 5px;
            color: #a0a0a0;
            font-size: 14px;
        }

        input[type="range"] {
            width: 200px;
            height: 6px;
            background: #333;
            outline: none;
            border-radius: 3px;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            background: #4facfe;
            border-radius: 50%;
            cursor: pointer;
        }

        button {
            background: linear-gradient(45deg, #00f2fe, #4facfe);
            color: #000;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            margin-right: 10px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }

        button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.4);
        }

        .back-button {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(26, 26, 46, 0.9);
            padding: 10px 20px;
            border-radius: 25px;
            text-decoration: none;
            color: #4facfe;
            transition: all 0.3s ease;
            z-index: 100;
        }

        .back-button:hover {
            transform: scale(1.05);
            background: rgba(79, 172, 254, 0.2);
        }

        .info {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(26, 26, 46, 0.9);
            padding: 15px;
            border-radius: 10px;
            font-size: 14px;
            color: #a0a0a0;
            z-index: 100;
        }

        .log-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #4facfe;
            color: #000;
            border: none;
            padding: 15px 30px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .log-panel {
            position: fixed;
            right: -400px;
            top: 0;
            width: 400px;
            height: 100vh;
            background: rgba(15, 15, 15, 0.95);
            border-left: 2px solid #4facfe;
            transition: right 0.3s ease;
            z-index: 999;
            overflow-y: auto;
            padding: 20px;
        }

        .log-panel.active {
            right: 0;
        }

        .log-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #333;
        }

        .log-entries {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.6;
        }

        .log-entry {
            margin-bottom: 8px;
            padding: 8px;
            background: rgba(79, 172, 254, 0.1);
            border-radius: 4px;
            border-left: 3px solid #4facfe;
        }

        .version-display {
            position: fixed;
            top: 20px;
            right: 80px;
            background: rgba(26, 26, 46, 0.9);
            color: #4facfe;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            border: 1px solid rgba(79, 172, 254, 0.3);
            z-index: 1000;
            backdrop-filter: blur(10px);
        }
    </style>
</head>
<body>
    <div class="version-display">v0.5</div>
    <div id="canvas-container"></div>

    <div class="controls">
        <h2>p5.js „Ç≥„É≥„Éà„É≠„Éº„É´</h2>
        
        <div class="control-group">
            <label>„Éë„Éº„ÉÜ„Ç£„ÇØ„É´Êï∞</label>
            <input type="range" id="particleCount" min="10" max="500" step="10" value="100">
        </div>

        <div class="control-group">
            <label>ÈÄüÂ∫¶</label>
            <input type="range" id="speed" min="0.1" max="5" step="0.1" value="1">
        </div>

        <div class="control-group">
            <label>„Çµ„Ç§„Ç∫</label>
            <input type="range" id="size" min="1" max="20" step="1" value="5">
        </div>

        <div class="control-group">
            <button onclick="changeMode('particles')">„Éë„Éº„ÉÜ„Ç£„ÇØ„É´</button>
            <button onclick="changeMode('waves')">Ê≥¢ÂΩ¢</button>
            <button onclick="changeMode('spiral')">„Çπ„Éë„Ç§„É©„É´</button>
        </div>

        <div class="control-group">
            <button onclick="toggleTrails()">ËªåË∑°Ë°®Á§∫</button>
            <button onclick="resetCanvas()">„É™„Çª„ÉÉ„Éà</button>
        </div>
    </div>

    <a href="index.html" class="back-button">‚Üê Êàª„Çã</a>

    <div class="info">
        „Éû„Ç¶„Çπ„ÅßÁîªÈù¢„Çí„ÇØ„É™„ÉÉ„ÇØ„Åô„Çã„Å®„Ç§„É≥„Çø„É©„ÇØ„Ç∑„Éß„É≥„ÅåÁô∫Áîü„Åó„Åæ„Åô
    </div>

    <button class="log-toggle" onclick="toggleLog()">üìã Êìç‰Ωú„É≠„Ç∞</button>

    <div id="log-panel" class="log-panel">
        <div class="log-header">
            <h3>üìã Êìç‰Ωú„É≠„Ç∞</h3>
            <button onclick="copyLogs()" style="background: #4facfe; color: #000; border: none; padding: 8px 16px; border-radius: 20px; cursor: pointer;">„Ç≥„Éî„Éº</button>
        </div>
        <div id="log-entries" class="log-entries"></div>
    </div>

    <script>
        // „É≠„Ç∞„Ç∑„Çπ„ÉÜ„É†
        class OperationLogger {
            constructor() {
                this.logs = [];
                this.logContainer = document.getElementById('log-entries');
                this.addLog('system', 'p5.js „Éá„É¢„ÇíËµ∑Âãï„Åó„Åæ„Åó„Åü');
            }

            addLog(action, details, type = 'info') {
                const timestamp = new Date().toLocaleTimeString('ja-JP');
                const logEntry = {
                    timestamp,
                    action,
                    details,
                    type
                };
                
                this.logs.push(logEntry);
                this.renderLog(logEntry);
            }

            renderLog(entry) {
                const logDiv = document.createElement('div');
                logDiv.className = 'log-entry';
                logDiv.innerHTML = `<span style="color: #4facfe; font-weight: bold;">[${entry.timestamp}]</span> <span style="color: #00f2fe;">${entry.action}</span> ‚Üí ${entry.details}`;
                this.logContainer.appendChild(logDiv);
                this.logContainer.scrollTop = this.logContainer.scrollHeight;
            }

            getFormattedLogs() {
                return this.logs.map(log => `[${log.timestamp}] ${log.action} ‚Üí ${log.details}`).join('\n');
            }
        }

        const logger = new OperationLogger();

        // p5.js Â§âÊï∞
        let particles = [];
        let particleCount = 100;
        let speedMultiplier = 1;
        let particleSize = 5;
        let currentMode = 'particles';
        let showTrails = false;
        let time = 0;

        // p5.js „Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó
        function setup() {
            const canvas = createCanvas(windowWidth, windowHeight);
            canvas.parent('canvas-container');
            
            // „Éë„Éº„ÉÜ„Ç£„ÇØ„É´ÂàùÊúüÂåñ
            for (let i = 0; i < particleCount; i++) {
                particles.push(new Particle());
            }
            
            logger.addLog('p5.js', '„Ç≠„É£„É≥„Éê„Çπ„ÇíÂàùÊúüÂåñ„Åó„Åæ„Åó„Åü');
        }

        function draw() {
            if (!showTrails) {
                background(10, 10, 10);
            } else {
                background(10, 10, 10, 20);
            }
            
            time += 0.01 * speedMultiplier;
            
            switch(currentMode) {
                case 'particles':
                    drawParticles();
                    break;
                case 'waves':
                    drawWaves();
                    break;
                case 'spiral':
                    drawSpiral();
                    break;
            }
        }

        function drawParticles() {
            particles.forEach(p => {
                p.update();
                p.display();
                
                // „Éû„Ç¶„ÇπËøë„Åè„ÅÆ„Éë„Éº„ÉÜ„Ç£„ÇØ„É´„Å®Êé•Á∂ö
                if (dist(mouseX, mouseY, p.x, p.y) < 100) {
                    stroke(79, 172, 254, 100);
                    strokeWeight(1);
                    line(mouseX, mouseY, p.x, p.y);
                }
            });
        }

        function drawWaves() {
            push();
            translate(width / 2, height / 2);
            noFill();
            
            for (let i = 0; i < 20; i++) {
                stroke(79 + i * 5, 172 - i * 3, 254, 150);
                strokeWeight(2);
                beginShape();
                for (let angle = 0; angle < TWO_PI; angle += 0.1) {
                    let r = 100 + i * 20 + sin(angle * 5 + time + i) * 30;
                    let x = r * cos(angle);
                    let y = r * sin(angle);
                    vertex(x, y);
                }
                endShape(CLOSE);
            }
            pop();
        }

        function drawSpiral() {
            push();
            translate(width / 2, height / 2);
            noFill();
            
            for (let i = 0; i < 5; i++) {
                stroke(0, 242 - i * 30, 254, 200);
                strokeWeight(3);
                beginShape();
                for (let t = 0; t < 20; t += 0.1) {
                    let angle = t + time + i * 0.5;
                    let r = t * 10;
                    let x = r * cos(angle);
                    let y = r * sin(angle);
                    vertex(x, y);
                }
                endShape();
            }
            pop();
        }

        // „Éë„Éº„ÉÜ„Ç£„ÇØ„É´„ÇØ„É©„Çπ
        class Particle {
            constructor() {
                this.x = random(width);
                this.y = random(height);
                this.vx = random(-2, 2);
                this.vy = random(-2, 2);
                this.color = color(random(50, 255), random(150, 255), 254);
            }
            
            update() {
                this.x += this.vx * speedMultiplier;
                this.y += this.vy * speedMultiplier;
                
                if (this.x < 0 || this.x > width) this.vx *= -1;
                if (this.y < 0 || this.y > height) this.vy *= -1;
            }
            
            display() {
                noStroke();
                fill(this.color);
                ellipse(this.x, this.y, particleSize);
            }
        }

        // „Éû„Ç¶„Çπ„ÇØ„É™„ÉÉ„ÇØ„Ç§„Éô„É≥„Éà
        function mousePressed() {
            if (mouseX > 0 && mouseX < width && mouseY > 0 && mouseY < height) {
                for (let i = 0; i < 10; i++) {
                    let p = new Particle();
                    p.x = mouseX;
                    p.y = mouseY;
                    particles.push(p);
                }
                if (particles.length > 500) {
                    particles.splice(0, 10);
                }
                logger.addLog('„Éû„Ç¶„ÇπÊìç‰Ωú', `Â∫ßÊ®ô(${Math.round(mouseX)}, ${Math.round(mouseY)})„Åß„Éë„Éº„ÉÜ„Ç£„ÇØ„É´ÁîüÊàê`);
            }
        }

        // „Ç≥„É≥„Éà„É≠„Éº„É´Èñ¢Êï∞
        function changeMode(mode) {
            currentMode = mode;
            logger.addLog('„É¢„Éº„ÉâÂ§âÊõ¥', `${mode}„É¢„Éº„Éâ„Å´Â§âÊõ¥„Åó„Åæ„Åó„Åü`);
        }

        function toggleTrails() {
            showTrails = !showTrails;
            logger.addLog('Ë°®Á§∫Ë®≠ÂÆö', showTrails ? 'ËªåË∑°Ë°®Á§∫ON' : 'ËªåË∑°Ë°®Á§∫OFF');
        }

        function resetCanvas() {
            particles = [];
            for (let i = 0; i < particleCount; i++) {
                particles.push(new Particle());
            }
            logger.addLog('„É™„Çª„ÉÉ„Éà', '„Ç≠„É£„É≥„Éê„Çπ„Çí„É™„Çª„ÉÉ„Éà„Åó„Åæ„Åó„Åü');
        }

        // „Çπ„É©„Ç§„ÉÄ„Éº„Ç§„Éô„É≥„Éà
        document.getElementById('particleCount').addEventListener('input', (e) => {
            particleCount = parseInt(e.target.value);
            particles = [];
            for (let i = 0; i < particleCount; i++) {
                particles.push(new Particle());
            }
            logger.addLog('„Éë„Éº„ÉÜ„Ç£„ÇØ„É´Êï∞', `${particleCount}ÂÄã„Å´Â§âÊõ¥`);
        });

        document.getElementById('speed').addEventListener('input', (e) => {
            speedMultiplier = parseFloat(e.target.value);
            logger.addLog('ÈÄüÂ∫¶Ë™øÊï¥', `ÈÄüÂ∫¶ÂÄçÁéá: ${speedMultiplier}`);
        });

        document.getElementById('size').addEventListener('input', (e) => {
            particleSize = parseInt(e.target.value);
            logger.addLog('„Çµ„Ç§„Ç∫Ë™øÊï¥', `„Éë„Éº„ÉÜ„Ç£„ÇØ„É´„Çµ„Ç§„Ç∫: ${particleSize}`);
        });

        // „É≠„Ç∞„Éë„Éç„É´
        function toggleLog() {
            const panel = document.getElementById('log-panel');
            panel.classList.toggle('active');
            logger.addLog('„É≠„Ç∞„Éë„Éç„É´', panel.classList.contains('active') ? 'Èñã„Åç„Åæ„Åó„Åü' : 'Èñâ„Åò„Åæ„Åó„Åü');
        }

        function copyLogs() {
            const logText = logger.getFormattedLogs();
            navigator.clipboard.writeText(logText).then(() => {
                logger.addLog('„É≠„Ç∞„Ç≥„Éî„Éº', '„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éî„Éº„Åó„Åæ„Åó„Åü');
            });
        }

        // „Ç¶„Ç£„É≥„Éâ„Ç¶„É™„Çµ„Ç§„Ç∫ÂØæÂøú
        function windowResized() {
            resizeCanvas(windowWidth, windowHeight);
            logger.addLog('ÁîªÈù¢„É™„Çµ„Ç§„Ç∫', `${windowWidth}x${windowHeight}„Å´Â§âÊõ¥`);
        }
    </script>
</body>
</html>